{"version":3,"sources":["dao/CalculationDao.js"],"names":["System","register","_export2","_context2","setters","execute","_export","_context","Calculation","_createClass","CalculationDao","_modelsCalculation","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","connection","instance","TypeError","_classCallCheck","this","_connection","_store","value","calculation","_this","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","error","_this2","cursor","openCursor","calculations","actual","result","data","push","_date","_expression","_result","continue","_this3","clear"],"mappings":"AAAA,aAEAA,OAAOC,SAAS,GAAI,SAAUC,EAAUC,GAGpC,MAAO,CACHC,QAAS,GACTC,QAAS,WACLL,OAAOC,SAAS,CAAC,yBAA0B,SAAUK,EAASC,GAG1D,IAAIC,EAAaC,EAAcC,EAQ/B,MAAO,CACHN,QAAS,CAAC,SAAUO,GAChBH,EAAcG,EAAmBH,cAErCH,QAAS,WACLI,EAAe,WACX,SAASG,EAAiBC,EAAQC,GAC9B,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CACnC,IAAIE,EAAaH,EAAMC,GACvBE,EAAWC,WAAaD,EAAWC,aAAc,EACjDD,EAAWE,cAAe,EACtB,UAAWF,IAAYA,EAAWG,UAAW,GACjDC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAItD,OAAO,SAAUO,EAAaC,EAAYC,GAGtC,OAFID,GAAYb,EAAiBY,EAAYG,UAAWF,GACpDC,GAAad,EAAiBY,EAAaE,GACxCF,GAdA,GAkBflB,EAAQ,iBAAkBI,EAAiB,WACvC,SAASA,EAAekB,IA9BpC,SAAyBC,EAAUL,GAC/B,KAAMK,aAAoBL,GACtB,MAAM,IAAIM,UAAU,qCA6BZC,CAAgBC,KAAMtB,GAEtBsB,KAAKC,YAAcL,EACnBI,KAAKE,OAAS,eA0ElB,OAvEAzB,EAAaC,EAAgB,CAAC,CAC1Ba,IAAK,MACLY,MAAO,SAAaC,GAChB,IAAIC,EAAQL,KAEZ,OAAO,IAAIM,QAAQ,SAAUC,EAASC,GAElC,IAAIC,EAAUJ,EAAMJ,YAAYS,YAAY,CAACL,EAAMH,QAAS,aAAaS,YAAYN,EAAMH,QAAQU,IAAIR,GAEvGK,EAAQI,UAAY,SAAUC,GAC1B,OAAOP,KAEXE,EAAQM,QAAU,SAAUD,GACxBE,QAAQC,IAAIH,EAAEjC,OAAOqC,OACrBV,EAAO,oDAIpB,CACCjB,IAAK,UACLY,MAAO,WACH,IAAIgB,EAASnB,KAEb,OAAO,IAAIM,QAAQ,SAAUC,EAASC,GAElC,IAAIY,EAASD,EAAOlB,YAAYS,YAAY,CAACS,EAAOjB,QAAS,aAAaS,YAAYQ,EAAOjB,QAAQmB,aAEjGC,EAAe,GAEnBF,EAAOP,UAAY,SAAUC,GACzB,IAAIS,EAAST,EAAEjC,OAAO2C,OAEtB,GAAID,EAAQ,CAER,IAAIE,EAAOF,EAAOpB,MAElBmB,EAAaI,KAAK,IAAIlD,EAAYiD,EAAKE,MAAOF,EAAKG,YAAaH,EAAKI,UAErEN,EAAOO,gBAEPvB,EAAQe,IAIhBF,EAAOL,QAAU,SAAUD,GACvBE,QAAQC,IAAIH,EAAEjC,OAAOqC,OACrBV,EAAO,qDAIpB,CACCjB,IAAK,WACLY,MAAO,WACH,IAAI4B,EAAS/B,KAEb,OAAO,IAAIM,QAAQ,SAAUC,EAASC,GAElC,IAAIC,EAAUsB,EAAO9B,YAAYS,YAAY,CAACqB,EAAO7B,QAAS,aAAaS,YAAYoB,EAAO7B,QAAQ8B,QAEtGvB,EAAQI,UAAY,SAAUC,GAC1B,OAAOP,KAGXE,EAAQM,QAAU,SAAUD,GACxBE,QAAQC,IAAIH,EAAEjC,OAAOqC,OACrBV,EAAO,wDAMhB9B,EA/EgC,IAkF3CJ,EAAQ,iBAAkBI","file":"CalculationDao.js","sourcesContent":["'use strict';\n\nSystem.register([], function (_export2, _context2) {\n    \"use strict\";\n\n    return {\n        setters: [],\n        execute: function () {\n            System.register(['../models/Calculation'], function (_export, _context) {\n                \"use strict\";\n\n                var Calculation, _createClass, CalculationDao;\n\n                function _classCallCheck(instance, Constructor) {\n                    if (!(instance instanceof Constructor)) {\n                        throw new TypeError(\"Cannot call a class as a function\");\n                    }\n                }\n\n                return {\n                    setters: [function (_modelsCalculation) {\n                        Calculation = _modelsCalculation.Calculation;\n                    }],\n                    execute: function () {\n                        _createClass = function () {\n                            function defineProperties(target, props) {\n                                for (var i = 0; i < props.length; i++) {\n                                    var descriptor = props[i];\n                                    descriptor.enumerable = descriptor.enumerable || false;\n                                    descriptor.configurable = true;\n                                    if (\"value\" in descriptor) descriptor.writable = true;\n                                    Object.defineProperty(target, descriptor.key, descriptor);\n                                }\n                            }\n\n                            return function (Constructor, protoProps, staticProps) {\n                                if (protoProps) defineProperties(Constructor.prototype, protoProps);\n                                if (staticProps) defineProperties(Constructor, staticProps);\n                                return Constructor;\n                            };\n                        }();\n\n                        _export('CalculationDao', CalculationDao = function () {\n                            function CalculationDao(connection) {\n                                _classCallCheck(this, CalculationDao);\n\n                                this._connection = connection;\n                                this._store = 'calculations';\n                            }\n\n                            _createClass(CalculationDao, [{\n                                key: 'add',\n                                value: function add(calculation) {\n                                    var _this = this;\n\n                                    return new Promise(function (resolve, reject) {\n\n                                        var request = _this._connection.transaction([_this._store], 'readwrite').objectStore(_this._store).add(calculation);\n\n                                        request.onsuccess = function (e) {\n                                            return resolve();\n                                        };\n                                        request.onerror = function (e) {\n                                            console.log(e.target.error);\n                                            reject('Failed on saving calculation into IndexedDB');\n                                        };\n                                    });\n                                }\n                            }, {\n                                key: 'listAll',\n                                value: function listAll() {\n                                    var _this2 = this;\n\n                                    return new Promise(function (resolve, reject) {\n\n                                        var cursor = _this2._connection.transaction([_this2._store], 'readwrite').objectStore(_this2._store).openCursor();\n\n                                        var calculations = [];\n\n                                        cursor.onsuccess = function (e) {\n                                            var actual = e.target.result;\n\n                                            if (actual) {\n\n                                                var data = actual.value;\n\n                                                calculations.push(new Calculation(data._date, data._expression, data._result));\n\n                                                actual.continue();\n                                            } else {\n                                                resolve(calculations);\n                                            }\n                                        };\n\n                                        cursor.onerror = function (e) {\n                                            console.log(e.target.error);\n                                            reject('Failed on listing calculation from IndexedDB');\n                                        };\n                                    });\n                                }\n                            }, {\n                                key: 'clearAll',\n                                value: function clearAll() {\n                                    var _this3 = this;\n\n                                    return new Promise(function (resolve, reject) {\n\n                                        var request = _this3._connection.transaction([_this3._store], 'readwrite').objectStore(_this3._store).clear();\n\n                                        request.onsuccess = function (e) {\n                                            return resolve();\n                                        };\n\n                                        request.onerror = function (e) {\n                                            console.log(e.target.error);\n                                            reject('Failed on deleting calculation from IndexedDB');\n                                        };\n                                    });\n                                }\n                            }]);\n\n                            return CalculationDao;\n                        }());\n\n                        _export('CalculationDao', CalculationDao);\n                    }\n                };\n            });\n        }\n    };\n});"]}