"use strict";System.register([],function(t,n){return{setters:[],execute:function(){System.register(["./HttpService","./ConnectionFactory","../dao/CalculationDao","../models/Calculation"],function(t,n){var e,r,u,o,c,a;return{setters:[function(t){e=t.HttpService},function(t){r=t.ConnectionFactory},function(t){u=t.CalculationDao},function(t){o=t.Calculation}],execute:function(){c=function(){function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}}(),t("CalculationService",a=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._http=new e}return c(t,[{key:"requestLocalCalculations",value:function(){return r.getConnection().then(function(t){return new u(t)}).then(function(t){return t.listAll()})}},{key:"requestCalculations",value:function(){return Promise.all([this.requestOldCalculations(),this.requestYesterdaysCalculations(),this.requestTodaysCalculations()]).then(function(t){return t.reduce(function(t,n){return t.concat(n)},[])}).catch(function(t){throw new Error(t)})}},{key:"requestTodaysCalculations",value:function(){var t=this;return new Promise(function(n,e){t._http.get("http://localhost:9003/calcs/day").then(function(t){return n(t.map(function(t){return new o(new Date(t.date),t.expression,t.result)}))}).catch(function(t){return e(t)})})}},{key:"requestYesterdaysCalculations",value:function(){var t=this;return new Promise(function(n,e){t._http.get("http://localhost:9003/calcs/yesterday").then(function(t){return n(t.map(function(t){return new o(new Date(t.date),t.expression,t.result)}))}).catch(function(t){return e(t)})})}},{key:"requestOldCalculations",value:function(){var t=this;return new Promise(function(n,e){t._http.get("http://localhost:9003/calcs/old").then(function(t){return n(t.map(function(t){return new o(new Date(t.date),t.expression,t.result)}))}).catch(function(t){return e(t)})})}},{key:"postCalculation",value:function(n){var e=this;return r.getConnection().then(function(t){return new u(t)}).then(function(t){return t.add(n)}).then(function(){var t={date:n.date,expression:n.expression,result:n.result};e._http.post("http://localhost:9003/calc",t).catch(function(t){throw new Error(t)})})}},{key:"clearCalculations",value:function(){return r.getConnection().then(function(t){return new u(t)}).then(function(t){return t.clearAll()})}}]),t}()),t("CalculationService",a)}}})}}});
//# sourceMappingURL=CalculationService.js.map
